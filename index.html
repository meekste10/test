<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Week 1 — Performance vs Madden</title>
<style>
  :root {
    --bg:#0b1022; --panel:#12172b; --soft:#1a2240; --text:#e7ecff; --muted:#a7b1d9; --good:#11c46a; --bad:#ff5d5d; --accent:#6fe3ff;
  }
  html,body{margin:0;padding:0;background:linear-gradient(180deg,#0a0f22,#0b1022 40%,#080c1a);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Inter,Ubuntu,sans-serif}
  header{position:sticky;top:0;z-index:10;background:rgba(11,16,34,0.85);backdrop-filter:saturate(160%) blur(10px);padding:10px 12px;border-bottom:1px solid #1e2644}
  h1{margin:0;font-size:18px;letter-spacing:.2px}
  .controls{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
  input,select,button{appearance:none;background:var(--soft);color:var(--text);border:1px solid #273059;border-radius:12px;padding:10px 12px;font-size:14px}
  input[type=search]{flex:1;min-width:46%}
  select{min-width:120px}
  button{border-color:#2d6cff}
  .wrap{padding:14px}
  .grid{display:grid;grid-template-columns:1fr;gap:10px}
  @media(min-width:700px){.grid{grid-template-columns:1fr 1fr}}
  .card{background:linear-gradient(180deg,rgba(23,33,62,.9),rgba(18,23,43,.95));border:1px solid #1e2748;border-radius:16px;padding:12px;display:flex;gap:10px;align-items:center}
  .badge{background:#0f1634;border:1px solid #26305b;color:#c6d2ff;border-radius:10px;padding:4px 8px;font-size:12px}
  .ovr{font-weight:700;color:#ffd76b}
  .delta{font-weight:700}
  .delta.pos{color:var(--good)}
  .delta.neg{color:var(--bad)}
  .name{font-size:16px;font-weight:700}
  .muted{color:var(--muted)}
  .stats{font-size:13px;color:#dce6ff}
  .row{display:flex;justify-content:space-between;gap:8px;align-items:baseline}
  .sub{font-size:12px;color:var(--muted)}
  .pill{background:#0f1938;border:1px solid #2a3563;border-radius:999px;padding:4px 8px;font-size:12px}
  .footer{text-align:center;color:var(--muted);font-size:12px;margin:18px 0}
</style>
</head>
<body>
<header>
  <h1>Week 1 · Performance vs. Madden</h1>
  <div class="controls">
    <input id="q" type="search" placeholder="Search player (e.g., Kupp, Allen, Worthy)">
    <select id="team">
      <option value="">All teams</option>
      <option value="ARI">ARI</option><option value="BAL">BAL</option><option value="BUF">BUF</option><option value="CAR">CAR</option><option value="CHI">CHI</option><option value="DET">DET</option><option value="DEN">DEN</option><option value="HOU">HOU</option><option value="IND">IND</option><option value="KC">KC</option><option value="LA">LA</option><option value="NO">NO</option><option value="NYJ">NYJ</option><option value="SEA">SEA</option><option value="SF">SF</option><option value="TB">TB</option><option value="TEN">TEN</option><option value="WAS">WAS</option>
    </select>
    <select id="sort">
      <option value="delta">Biggest surprises</option>
      <option value="perf_score">Best performance</option>
      <option value="madden_ovr">Madden OVR</option>
      <option value="name">Name A→Z</option>
    </select>
    <button id="export">Export CSV</button>
  </div>
</header>
<div class="wrap">
  <div id="list" class="grid"></div>
  <div class="footer">Built from your Week 1 game files &amp; Madden 25 ratings. On iPhone, tap a card to copy stats.</div>
</div>

<script>
const DATA = [{"player":"Cooper Kupp","display":"C.Kupp","team":"LA","pos":"WR","madden_ovr":88,"pass_yards":0,"pass_tds":0,"ints":0,"rush_yards":0,"rush_tds":0,"rec_yards":101,"rec_tds":0,"receptions":13,"perf_score":23.1,"exp_score":8.931675990158787,"delta":14.168324009841214}, /* … DATA TRUNCATED IN THIS VIEW … */ ];

function fmt(n, d=1){ return (Math.round(n*10**d)/10**d).toFixed(d); }
function toCSV(rows) {
  const cols = Object.keys(rows[0]);
  const lines = [cols.join(',')];
  for (const r of rows) {
    lines.push(cols.map(c => JSON.stringify(r[c] ?? '')).join(','));
  }
  return lines.join('\n');
}

function render() {
  const list = document.getElementById('list');
  const q = document.getElementById('q').value.trim().toLowerCase();
  const team = document.getElementById('team').value;
  const sort = document.getElementById('sort').value;
  let rows = DATA.slice();

  if (q) rows = rows.filter(r => (r.player||'').toLowerCase().includes(q) || (r.display||'').toLowerCase().includes(q));
  if (team) rows = rows.filter(r => r.team === team);

  if (sort === 'delta') rows.sort((a,b)=> (b.delta??-1) - (a.delta??-1));
  if (sort === 'perf_score') rows.sort((a,b)=> (b.perf_score??0) - (a.perf_score??0));
  if (sort === 'madden_ovr') rows.sort((a,b)=> (b.madden_ovr??0) - (a.madden_ovr??0));
  if (sort === 'name') rows.sort((a,b)=> (''+(a.player||a.display)).localeCompare(''+(b.player||b.display)));

  list.innerHTML = '';
  for (const r of rows) {
    const delta = r.delta ?? 0;
    const deltaClass = delta >= 0 ? 'pos' : 'neg';
    const el = document.createElement('div');
    el.className = 'card';
    el.innerHTML = `
      <div style="flex:1">
        <div class="row">
          <div class="name">${r.player || r.display} <span class="muted">(${r.team}${r.pos ? ' · '+r.pos : ''})</span></div>
          <div class="pill">Δ <span class="delta ${deltaClass}">${fmt(delta)}</span></div>
        </div>
        <div class="row sub">
          <div>Madden <span class="ovr">${Math.round(r.madden_ovr||0)}</span></div>
          <div>Perf <b>${fmt(r.perf_score||0)}</b> · Exp ${fmt(r.exp_score||0)}</div>
        </div>
        <div class="stats">
          ${statline(r)}
        </div>
      </div>
    `;
    el.addEventListener('click', ()=> {
      const txt = `${r.player||r.display} (${r.team}${r.pos? ' · '+r.pos:''}) — Madden ${Math.round(r.madden_ovr||0)}; Perf ${fmt(r.perf_score||0)} (Exp ${fmt(r.exp_score||0)}, Δ ${fmt(delta)}). ${statline(r)}`;
      navigator.clipboard?.writeText(txt);
    });
    list.appendChild(el);
  }
}

function statline(r) {
  const parts = [];
  if ((r.pass_yards||0)!==0 || (r.pass_tds||0)!==0 || (r.ints||0)!==0) parts.push(`Pass: ${r.pass_yards}y / ${r.pass_tds} TD / ${r.ints} INT`);
  if ((r.rush_yards||0)!==0 || (r.rush_tds||0)!==0) parts.push(`Rush: ${r.rush_yards}y / ${r.rush_tds} TD`);
  if ((r.receptions||0)!==0 || (r.rec_yards||0)!==0 || (r.rec_tds||0)!==0) parts.push(`Rec: ${r.receptions} / ${r.rec_yards}y / ${r.rec_tds} TD`);
  return parts.join(' • ') || '—';
}

document.getElementById('q').addEventListener('input', render);
document.getElementById('team').addEventListener('change', render);
document.getElementById('sort').addEventListener('change', render);
document.getElementById('export').addEventListener('click', ()=> {
  const blob = new Blob([toCSV(DATA)], {type:'text/csv'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'week1_perf_vs_madden.csv';
  a.click();
});

render();
</script>
</body>
</html>